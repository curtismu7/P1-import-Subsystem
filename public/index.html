<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PingOne User Management</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- Ping Identity Official CSS -->
    <link rel="stylesheet" href="https://assets.pingone.com/ux/end-user-nano/0.1.0-alpha.9/end-user-nano.css">
    <link rel="stylesheet" href="https://assets.pingone.com/ux/astro-nano/0.1.0-alpha.11/icons.css">
    
    <!-- Material Design Icons Fallback -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@7.4.47/css/materialdesignicons.min.css">
    
          <!-- Custom PingOne UI CSS -->
      <link rel="stylesheet" href="/css/pingone-ui-custom.css?v=20250814130500">
      
      <!-- Main CSS with cache busting -->
      <link rel="stylesheet" href="/css/main.css?v=20250814130500">
    
    <!-- Import Maps Configuration -->
    <script type="importmap">
    {
        "imports": {
            "@/": "/",
            "@/js/": "/js/",
            "@/components/": "/js/components/",
            "@/modules/": "/js/modules/",
            "@/utils/": "/js/utils/",
            "@/state/": "/js/state/",
            "app": "/js/app.js",
            "ui-manager": "/js/modules/ui-manager.js",
            "api-client": "/js/modules/api-client.js",
            "settings-manager": "/js/modules/settings-manager.js",
            "home-page": "./js/pages/home-page.js",
            "settings-page": "./js/pages/settings-page.js",
            "import-page": "./js/pages/import-page.js",
            "export-page": "./js/pages/export-page.js",
            "csrf-utils": "./js/utils/csrf-utils.js"
        }
    }
    </script>
</head>
<body>
    <!-- Browser frame removed -->

    <!-- Status Message Area -->
    <div class="status-message-bar" id="status-message-bar">
        <div class="status-message-content">
            <div class="status-message" id="status-message">
                <i class="icon-check-circle" id="status-icon"></i>
                <span id="status-text">Server started at: --/--/---- --:--:--</span>
            </div>
        </div>
    </div>

    <!-- Top Header Bar -->
    <div class="top-status-bar" id="top-status-bar">
        <div class="status-content">
            <div class="status-left">
                <span class="token-info" id="token-info">
                    <span class="token-indicator" id="token-indicator"></span>
                    <span class="token-text" id="token-text">Token: Checking...</span>
                    <span class="token-time" id="token-time"></span>
                </span>
            </div>
            <div class="status-center">
                <div class="header-content">
                    <h1 class="header-title">PingOne User Management</h1>
                    <span class="version-info" id="version-info">v...</span>
                </div>
            </div>
            <div class="status-right">
            </div>
        </div>
    </div>

    <!-- Main Application Layout -->
    <div class="app-container">
        <!-- Left Navigation -->
        <nav class="left-nav" id="left-nav">
            <div class="nav-header">
                <img src="/ping-identity-logo.svg" alt="Ping Identity" class="nav-logo">
                <h3 class="nav-title">Ping Identity<br/>User Management</h3>
                <button class="nav-toggle" id="nav-toggle" aria-label="Toggle navigation">
                    <i class="icon-menu"></i>
                </button>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#home" class="nav-link active" data-page="home">
                        <i class="icon-home"></i>
                        <span class="nav-text">Home</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#settings" class="nav-link" data-page="settings">
                        <i class="icon-settings"></i>
                        <span class="nav-text">Settings</span>
                    </a>
                </li>
                <li class="nav-divider"></li>
                <li class="nav-item">
                    <a href="#export" class="nav-link" data-page="export">
                        <i class="icon-download"></i>
                        <span class="nav-text">Export Users</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#import" class="nav-link" data-page="import">
                        <i class="icon-upload"></i>
                        <span class="nav-text">Import Users</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#delete" class="nav-link" data-page="delete">
                        <i class="icon-trash"></i>
                        <span class="nav-text">Delete Users</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#modify" class="nav-link" data-page="modify">
                        <i class="icon-edit"></i>
                        <span class="nav-text">Modify Users</span>
                    </a>
                </li>
                <li class="nav-divider"></li>
                <li class="nav-item">
                    <a href="#logs" class="nav-link" data-page="logs">
                        <i class="icon-file-text"></i>
                        <span class="nav-text">Logs</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#token-management" class="nav-link" data-page="token-management">
                        <i class="icon-key"></i>
                        <span class="nav-text">Token Management</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#history" class="nav-link" data-page="history">
                        <i class="icon-clock"></i>
                        <span class="nav-text">History</span>
                    </a>
                </li>
                <li class="nav-item" id="swagger-nav" style="display: none;">
                    <a href="#swagger" class="nav-link" data-page="swagger">
                        <i class="icon-code"></i>
                        <span class="nav-text">Swagger</span>
                    </a>
                </li>
                <li class="nav-divider"></li>
            </ul>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content" id="main-content">
            <!-- Home Page -->
            <div class="page" id="home-page" data-page="home">
                <div class="page-header">
                    <p class="page-subtitle">Manage users across your PingOne environment</p>
                </div>
                
                <div class="home-grid">
                    <div class="home-section">
                        <div class="section-header">
                            <h2>Settings</h2>
                        </div>
                        <div class="action-card" data-action="settings">
                            <div class="card-icon">
                                <i class="icon-settings"></i>
                            </div>
                            <div class="card-content">
                                <h3>Settings</h3>
                                <p>Configure PingOne credentials and preferences</p>
                                <div class="card-status" id="settings-status">Ready</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="home-divider"></div>
                    
                    <div class="home-section">
                        <div class="section-header">
                            <h2>User Operations</h2>
                        </div>
                        <div class="action-cards">
                            <div class="action-card" data-action="export">
                                <div class="card-icon">
                                    <i class="icon-download"></i>
                                </div>
                                <div class="card-content">
                                    <h3>Export Users</h3>
                                    <p>Export users to CSV file</p>
                                    <div class="card-status" id="export-status">Ready</div>
                                </div>
                            </div>
                            
                            <div class="action-card" data-action="import">
                                <div class="card-icon">
                                    <i class="icon-upload"></i>
                                </div>
                                <div class="card-content">
                                    <h3>Import Users</h3>
                                    <p>Import users from CSV file</p>
                                    <div class="card-status" id="import-status">Ready</div>
                                </div>
                            </div>
                            
                            <div class="action-card" data-action="delete">
                                <div class="card-icon">
                                    <i class="icon-trash"></i>
                                </div>
                                <div class="card-content">
                                    <h3>Delete Users</h3>
                                    <p>Delete users from CSV file</p>
                                    <div class="card-status" id="delete-status">Ready</div>
                                </div>
                            </div>
                            
                            <div class="action-card" data-action="modify">
                                <div class="card-icon">
                                    <i class="icon-edit"></i>
                                </div>
                                <div class="card-content">
                                    <h3>Modify Users</h3>
                                    <p>Update user attributes from CSV</p>
                                    <div class="card-status" id="modify-status">Ready</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="home-divider"></div>
                    
                    <div class="home-section">
                        <div class="section-header">
                            <h2>Management</h2>
                        </div>
                        <div class="action-cards">
                            <div class="action-card" data-action="logs">
                                <div class="card-icon">
                                    <i class="icon-file-text"></i>
                                </div>
                                <div class="card-content">
                                    <h3>Logs</h3>
                                    <p>View application logs and errors</p>
                                    <div class="card-status" id="logs-status">Ready</div>
                                </div>
                            </div>
                            
                            <div class="action-card" data-action="token-management">
                                <div class="card-icon">
                                    <i class="icon-key"></i>
                                </div>
                                <div class="card-content">
                                    <h3>Token Management</h3>
                                    <p>Manage API tokens and authentication</p>
                                    <div class="card-status" id="token-management-status">Ready</div>
                                </div>
                            </div>
                            
                            <div class="action-card" data-action="history">
                                <div class="card-icon">
                                    <i class="icon-clock"></i>
                                </div>
                                <div class="card-content">
                                    <h3>History</h3>
                                    <p>View past operations and activities</p>
                                    <div class="card-status" id="history-status">Ready</div>
                                </div>
                            </div>
                            
                            <div class="action-card" id="swagger-card" data-action="swagger" style="display: none;">
                                <div class="card-icon">
                                    <i class="icon-code"></i>
                                </div>
                                <div class="card-content">
                                    <h3>Swagger</h3>
                                    <p>API documentation and testing</p>
                                    <div class="card-status" id="swagger-status">Ready</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Other pages will be loaded dynamically -->
            <div class="page" id="settings-page" data-page="settings" style="display: none;"></div>
            <div class="page" id="export-page" data-page="export" style="display: none;"></div>
            <div class="page" id="import-page" data-page="import" style="display: none;"></div>
            <div class="page" id="delete-page" data-page="delete" style="display: none;"></div>
            <div class="page" id="modify-page" data-page="modify" style="display: none;"></div>
            <div class="page" id="logs-page" data-page="logs" style="display: none;"></div>
            <div class="page" id="token-management-page" data-page="token-management" style="display: none;"></div>
            <div class="page" id="history-page" data-page="history" style="display: none;"></div>
            <div class="page" id="swagger-page" data-page="swagger" style="display: none;"></div>
        </main>
    </div>

    <!-- Footer -->
    <footer class="app-footer" id="app-footer">
        <div class="footer-content">
            <div class="footer-left">
                <span class="copyright">© PingIdentity 2025</span>
                <span class="server-status" id="footer-server-status">
                    <span class="status-indicator" id="footer-server-indicator"></span>
                    <span class="status-text" id="footer-server-text">Starting...</span>
                </span>
            </div>
            <div class="footer-center">
                <span class="token-status-footer" id="footer-token-status">
                    <span class="status-indicator" id="footer-token-indicator"></span>
                    <span class="status-text" id="footer-token-text">Token: Checking...</span>
                    <span class="token-time" id="footer-token-time"></span>
                </span>
            </div>
            <div class="footer-right">
                <span class="version-info" id="footer-version">v...</span>
            </div>
        </div>
    </footer>

    <!-- Modals -->
    <!-- Disclaimer Modal (formal style) -->
    <div class="modal-overlay" id="disclaimer-modal" style="display: none;">
        <div class="modal disclaimer-modal" style="box-shadow: 0 8px 24px rgba(0,0,0,0.08); border: 1px solid rgba(0,0,0,0.08);">
            <div class="modal-header">
                <h2><i class="icon-alert-circle" aria-hidden="true"></i> Important Disclaimer</h2>
                <p class="subtitle">Please review and acknowledge before continuing</p>
            </div>
            <div class="modal-body">
                <section class="tos-panel" style="background:#f7f9fc; border:1px solid rgba(0,0,0,0.06); padding:16px; border-radius:8px;">
                    <h3>Ping Library Terms of Service</h3>
                    <p class="muted">The code provided hereunder shall be deemed "Sample Code." This Sample Code is to be used exclusively in connection with Ping Identity's software or services.</p>
                    <p class="muted">
                        THE CODE HEREUNDER IS PROVIDED “AS IS” AND WITHOUT WARRANTY OF ANY KIND. SUCH CODE IS EXPRESSLY EXCLUDED FROM PING IDENTITY'S INDEMNITY OR SUPPORT OBLIGATIONS, IF ANY, PURSUANT TO THE RELEVANT GOVERNING AGREEMENT. PING IDENTITY AND ITS LICENSORS EXPRESSLY DISCLAIM ALL WARRANTIES, WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND ANY WARRANTY OF NON-INFRINGEMENT. PING IDENTITY SHALL NOT HAVE ANY LIABILITY ARISING OUT OF OR RELATING TO ANY USE, IMPLEMENTATION OR CONFIGURATION OF THE SAMPLE CODE.
                    </p>
                </section>
                <div class="ack-row" style="margin-top:12px; display:flex; align-items:center; gap:8px;">
                    <input type="checkbox" id="disclaimer-agree" required>
                    <label for="disclaimer-agree"><strong>Terms of Service (Required)</strong></label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="disclaimer-quit">Quit</button>
                <button class="btn btn-primary" id="disclaimer-accept" disabled>Accept</button>
            </div>
        </div>
    </div>

    <!-- Credentials Modal -->
    <div class="modal-overlay" id="credentials-modal" style="display: none;">
        <div class="modal credentials-modal" style="max-width: 820px; width: 90%; max-height: 85vh; overflow: auto;">
            <div class="modal-header">
                <h2>PingOne Credentials</h2>
                <p>Configure your PingOne API credentials to get started</p>
            </div>
            <div class="modal-body">
                <form id="credentials-form" novalidate>
                    <div class="form-group field-control-wrapper">
                        <label for="cred-environment-id">PingOne Environment ID</label>
                        <input type="text" id="cred-environment-id" name="environmentId"
                               class="field-control-input is-default"
                               maxlength="256" data-pendo-id="Input"
                               autocomplete="off"
                               aria-label="PingOne Environment ID"
                               spellcheck="false"
                               required>
                    </div>
                    <div class="form-group field-control-wrapper">
                        <label for="cred-client-id">PingOne Client ID</label>
                        <input type="text" id="cred-client-id" name="clientId"
                               class="field-control-input is-default"
                               maxlength="256" data-pendo-id="Input"
                               autocomplete="username"
                               aria-label="PingOne Client ID"
                               spellcheck="false"
                               required>
                    </div>
                    <div class="form-group field-control-wrapper">
                        <label for="cred-client-secret">PingOne Client Secret</label>
                        <div class="input-group">
                            <input type="password" id="cred-client-secret" name="clientSecret"
                                   class="field-control-input is-default"
                                   maxlength="256" data-pendo-id="Input"
                                   autocomplete="current-password"
                                   aria-label="PingOne Client Secret"
                                   spellcheck="false"
                                   title="Show/hide client secret"
                                   aria-describedby="toggle-secret"
                                   required>
                            <button type="button" class="btn btn-icon" id="toggle-secret"
                                    title="Toggle secret visibility"
                                    aria-label="Show client secret">
                                <i class="icon-eye" aria-hidden="true"></i>
                            </button>
                        </div>
                    </div>
                    <div class="form-group field-control-wrapper">
                        <label for="cred-region">PingOne Region</label>
                        <select id="cred-region" name="region" autocomplete="country">
                            <option value="NorthAmerica">North America</option>
                            <option value="Europe">Europe</option>
                            <option value="Asia">Asia Pacific</option>
                            <option value="Canada">Canada</option>
                        </select>
                    </div>
                    <div class="form-group field-control-wrapper">
                        <label for="cred-population">PingOne Default Population (Optional)</label>
                        <select id="cred-population" name="populationId">
                            <option value="">Select a population...</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer" style="display:flex; justify-content:center; gap:16px;">
                <button class="btn btn-primary" id="credentials-save">Save & Get Token</button>
                <button class="btn btn-secondary" id="credentials-settings" style="background:#f3f4f6; border-color:#e5e7eb; color:#111827;">Go to Settings</button>
                <button class="btn btn-secondary" id="credentials-skip" style="background:#f3f4f6; border-color:#e5e7eb; color:#111827;">Continue to Home</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay" style="display: none;">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text" id="loading-text">Loading...</div>
        </div>
    </div>

    <!-- Main Application Script -->
    <script src="/socket.io/socket.io.js"></script>
    <script type="module" src="/js/app.js"></script>
    
    <!-- Error Handling -->
    <script>
        window.addEventListener('error', function(e) {
            console.error('Global error:', e.error);
        });
        
        window.addEventListener('unhandledrejection', function(e) {
            console.error('Unhandled promise rejection:', e.reason);
        });
    </script>
</body>
</html>